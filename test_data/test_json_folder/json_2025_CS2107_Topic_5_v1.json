{
  "1": "Topic 5: Network Security \u2022 Background o Layering o Port listening \u2022 MITM positions in the network \u2022 DNS, ARP, DoS attacks \u2022 Securing the channel using Cryptography o TLS, IPSec, WPA2, VPN o Firewalls and IDS \u2022 Useful tools (self explore)",
  "2": "Recap 1",
  "3": "\u2022 Cryptographic techniques + PKI,  we can secure a channel to achieve authenticity & confidentiality,  even in the presence of a Mallory. \u2022 Narrow focus : o Emphasizes securing a specific communication channel between two endpoints (e.g., server and client). o It is over-simplified in a network with large number of entities . \u2022 Broad scope : focuses on protecting an entire network or segments of a network - Routers, switches, firewalls, etc \u2022 This leads to next topic: Network Security. Recap",
  "4": "Background: Networking 2",
  "5": "\u2022 Computer network : a collection of interconnected devices (e.g., computers, servers, routers, switches) that can communicate with one another \u2022 Packet switching: To transmit data over the network, instead of having dedicated line between any two nodes, packet switching is deployed: o Messages are broken into \u201cpackets/frames\u201d. o Messages are \u201crouted\u201d via multiple switches and routers. Computer Network ID1 1 ID2 2 ID4 4 ID5 5 ID 6 ID 3",
  "6": "\u2022 Networking  focuses on how to route messages via the intermediate nodes. \u2022 In contrast, network security focuses on the attackers among the intermediate nodes . \u2022 An attacker wants to steal, modify, disrupt o Attackers modify the routing information so that traffic being routed to wrong places, or  to nowhere. o Attackers guess who-is-talking-to-who. Network Security ID1 1 ID2 2 ID4 4 ID5 5 ID 6 ID 3",
  "7": "\u2022 Suppose Alice is using her laptop at home to browse the website bbc.com . \u2022 The data go through multiple hops via intermediate nodes. \u2022 At each intermediate node,  routing data are being read and modified o Use \u201c traceroute \u201d command  to see the hops. Multiple Hops the images are by Singlar, , zaenul yahya, , Naba A'la Lail 'la Lail la Lail on The Noun Project Alice Laptop Home Wi-Fi Switch \u2026 Gateway (e.g., Modem from Singtel) Data Centre Gateway bbc server",
  "8": "\u2022 How to organize the structure of the network? \u2022 Network Layering : o Modularity : each layer can be developed and modified independently. o Abstraction : a specific set of functions and hides the underlying complexities from the layers above. o Isolation : potential issues or failures can be contained and addressed within a specific layer \u2022 Conceptually, virtual connection between layers at different host Network Layers Layer 4 Layer 3 Layer 2 Layer 1 Layer 4 Layer 3 Layer 2 Layer 1 Actual data exchange Peers at layer 3 use the services at layer 2.",
  "9": "Internet layers (TCP/IP Model): Layer 3 Network (aka IP) IP address Layer 3 Network (aka IP) 151.101.64.81 Transport (e.g., TCP, UDP) Port number Transport (e.g., TCP, UDP) 80 \u2026 Intermediate nodes Layer 2 Data Link MAC address Layer 2 Data Link 10:12:A3:44:55:61 Layer 1 Physical (Wi-Fi, Ethernet) Layer 1 Physical (Wi-Fi, Ethernet) Application (e.g., http) Domain name Application (e.g., http) bbc.com \"virtual connection in this layer\"",
  "10": "Data Flow Across the Layers Between Two Nodes Application (e.g., http) Transport (e.g., TCP,  UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical Application (e.g., http) Transport (e.g., TCP,  UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical Domain name data Port number data Transport header Datagram IP address Layer 3 payload Network header Packet mac address Layer 2 payload Data link header Frame Request the transport layer to send the data Request IP to send the datagrams Request the data link layer to send the Packets Source IP-address Destination IP-address Source Port Destination port Source mac Destination mac Application data",
  "11": "Multiple Hops and Network Layers the images are by Singlar, , zaenul yahya, , Naba A'la Lail 'la Lail la Lail on The Noun Project 00:00:11:11:51:00 192.168.0.100 3298 11:22:22:11:51:22 119.56.33.1 22:12:33:44:15:51 151.101.64.0 10:12:A3:44:55:61 151.101.64.81 80 Home gateway Application\u2019s Payload Going from 192.168.0.100 To 151.101.64.81 Going from 00:00:11:51:00 To  11:22:22:11:51:22 ISP Router Web Server Laptop Application\u2019s Payload Going from 119.56.33.1 To 151.101.64.81 Going from 11:22:22:11:51:22 To 33:33:22:11:11:00 \u2026 \u2026 Application\u2019s Payload Going from 119.56.33.1 To 151.101.64.81 Going from 22:12:33:44:15:51 To 10:12:A3:44:55:61 Remark:  The ip-address might be translated (gateway change 192.168.0.100 to 119.56.33.1) as shown in this example. In this class, for simplicity, we don\u2019t consider translation. ( need not know the domain name, only next hop router MAC addr)",
  "12": "\u2022 Very often, the transport layer and IP layer are treated as one single layer. \u2022 In this combined layer, the address of a communicating entity is an ip-address and a port - 151.101.64.81:80 \u2022 Each node in the network has a total 65535 ports. \u2022 A communication channel between two nodes is established by connecting two ports. \u2022 Two protocol in transport layer: o TCP (Transmission Control Protocol): connection-oriented, reliable data transfer o UDP (User Datagram Protocol): connectionless, non-reliable data transfer Transport + IP layer",
  "13": "Comm Channel: 11.11.1.1:2 and 55.55.5.5:65533. port 0 port 1 port 2 port 65533 port 65534 port 65536 port 0 port 1 port 2 port 65533 port 65534 port 65536 ip address: 11.11.1.1 ip address: 55.55.5.5 Going from left to right: src ip: 11.11.1.1 src port: 2 dest ip: 55.55.5.5 Dest port: 65533 Going from right to left: src ip: 55.55.5.5 src port: 65533 dest ip: 11.11.1.1 Dest port: 2",
  "14": "\u2022 We can imagine that behind certain ports (e.g., 65533) there are applications waiting to process data coming via the respective port. \u2022 In such cases, we say that the node/process  is \u201clistening\u201d to the port, and the port  is a \u201clistening , and the port  is a \u201clistening port\u201d. \u2022 If the port is not listening, then it is a \u201cclosed port\u201d. \u2022 Data sent to a closed port will be dropped. What do we mean by \u201clistening to a port\u201d, \u201cclosed port\u201d? port 0 port 1 port 2 port 65533 port 65534 port 65536 ip address: 11.11.1.1",
  "15": "Network Attacker 3",
  "16": "\u2022 TCP/IP is reliable but not \u201csecure\u201d. but not \u201csecure\u201d. . o Malicious intermediate nodes along the communication route can modify data in the header and payload \u2013 can be MITM o E.g., spoof an IP packet to inform one node to close the connection; reorder the packets; \u2022 Unless otherwise stated, the MITM can sniff, spoof, modify, drop the header and payload. \u2022 The MITM  in layer x means MITM along the layer x virtual connection. o The MITM can see and modify data unit of that layer . Who is the Man-In-The-Middle?",
  "17": "1) MITM in the physical layer. o E.g.  Tap into the Internet cable, sniff the wireless communication in caf\u00e9 2) MITM in the link layer. o E.g. Malicious caf\u00e9 owner who offer the Wi-Fi. 3) MITM in the IP/Transport layer. o E.g.  ISP (such as Singtel) 4) MITM in the application. o E.g. a malware in the browser. Where is the Man-In-The-Middle? Application (e.g., http) Transport (e.g., TCP,  UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical Application (e.g., http) Transport (e.g., TCP,  UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical (1) (2) (3) (4)",
  "18": "DNS Attacks 4",
  "19": "\u2022 Given a domain name (e.g., www.comp.nus.edu.sg), its ip address can be found by ), its ip address can be found by querying  a remote DNS server. \u2022 The client who initiates the query is called the resolver . o If the address is found, we say that the domain name is resolved. Domain Name System (DNS) $ nslookup www.comp.nus.edu.sg Server:       192.168.1.1 Address: 192.168.1.1#53 Non-authoritative answer: www.comp.nus.edu.sg canonical name = www0.comp.nus.edu.sg. Name: www.comp.nus.edu.sg Address: 137.132.80.57 Address of the DNS server result of the query The domain name to lookup www.comp.nus.edu.sg 137.132.80.57 DNS (Domain Name System) Security problems? \u2022 Confidentiality? \u2022 Integrity? \u2022 Availability?",
  "20": "\u2022 Client sends a query to DNS Server (using UDP protocol) \u2022 DNS sends the answer back (using UDP protocol) \u2022 The query contains a 16-bit number , known as QID (query ID). QID (query ID). (query ID). \u2022 The response from the server must also contains a QID. \u2022 If the QID in the response doesn\u2019t match the  QID in the query, the client rejects the answer. DNS Query and Answer Client DNS Server (1) What is the address of www.comp.nus.edu.sg ; QID = 6A ; QID = 6A (2) The answer is 137.132.80.57; QID = 6A Vulnerable?",
  "21": "\u2022 Alice is using a caf\u00e9 free Wi-Fi to surf the web. \u2022 Alice wants to visit and login to comp.nus.edu.sg comp.nus.edu.sg \u2022 We consider an attacker who is also in the caf\u00e9. Since the Wi-Fi is not protected, the attacker can o Sniff data from the communication channel. o Inject spoofed data into the communication channel. \u2022 However,  the attacker can\u2019t remove/modify data sent by Alice. \u2022 Attacker owns a webserver at 100.10.10.3 which is a spoofed NUS website. DNS Spoofing: Attack Scenario",
  "22": "DNS Spoofing Alice comp.nus.edu.sg 137.132.80.57 Fake comp.nus.edu.sg 100.10.100.3 DNS server 192.168.1.1 Attacker (1) What is the ip- address of comp.nus.edu.sg? QID = 6A (3) The answer is 137.132.80.57 (2) The answer is 100.10.10.3 QID = 6A (4) Hello 100.10.100.3 I want to log in Accept first reply as answer rejects Cannot verify if response is coming from correct source or has not been modified \u2013 only matches QID",
  "23": "\u2022 DNS is an important component as it resolves the domain name. \u2022 Hence, an DNS server can be a \u201c single-point-of-failure \u201d of the network. \u2022 A  denial of service (DoS)  attacks can be launched on a web service (i.e., DNS server), instead of directly attack the web server. \u2022 When DNS server is down, the web service is not longer reachable. \u2022 E.g.,  see attack on wikiLeak wikiLeak \u2022 Countermeasure : redundant servers, rate limiting, etc. Denial of Service on DNS",
  "24": "Poisoning ARP Table 5",
  "25": "\u2022 Resolution of IP address to mac address \u2022 Data Link Layer \u2022 When a device knows the the IP address of the next hop router on the same network but needs the corresponding MAC address \u2022 ARP resolves the router\u2019s IP address to its MAC address to allow packet forwarding at the Data Link Layer Address Resolution Protocol (ARP) www.comp.nus.edu.sg 137.132.80.57 01-02-03-04-05-06 ARP (Address Resolution Protocol) DNS (Domain Name System)",
  "26": "N1 1 N2 2 N3 3 fa:16:3e:d5:e0:14 fa:16:3e:f3:ea:4c fa:16:3e:ed:05:e4 \u2022 Direct data packets between devices or nodes on the same local network using MAC addresses \u2022 The switch keeps a table that associates the port to the mac-addresses. o N1 directs a data frame with destination MAC address of N3 to switch o Switch does a lookup to identify the port (i.e., port 3), then forward it to that port. \u2022 Switch doesn\u2019t understand IP-addresses and doesn\u2019t doesn\u2019t understand IP-addresses and doesn\u2019t and doesn\u2019t store IP-addresses. Switch Switch\u2019s p ort Mac-address 1 fa:16:3e:d5:e0:14 2 fa:16:3e:f3:ea:4c 3 fa:16:3e:ed:05:e4 1   2  3",
  "27": "\u2022 An ARP table is a database maintained by each device or nodes on a subnet, o It stores mappings between IP addresses and MAC addresses \u2022 Resolution of ip-address to mac-address is done by the nodes \u2022 The nodes update each others table using ARP. \u2022 ARP poisoning is an attack that modifies (aka \u201cpoisons\u201d) the tables so as to gain Man-In-The-Middle access. Address Resolution Protocol (ARP) Table i p -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.1.4 fa:16:3e:ed:05:e4 N 1",
  "28": "\u2022 Under normal circumstances, these are carried out when N2 sends a packet to 10.0.1.4 o N2 looks up the table T2. Resolve to fa:16:3e:ed:05:e4 o N2  sends the frame to the switch, specifying destination fa:16:3e:ed:05:e4 o Switch looks up the table T0, redirect the frame to port 3. When N 2 want to send to IP address 10.0.1.4 Switch Ip-address p-address -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.1.4 fa:16:3e:ed:05:e4 Switch\u2019s port port ort Mac-address 1 fa:16:3e:d5:e0:14 2 fa:16:3e:f3:ea:4c 3 fa:16:3e:ed:05:e4 T2 T0 T3 Ip-address p-address -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.3.5 fa:16:3e:f3:ea:4c N 1 1 N 2 2 N 3 3 frame 10.0.3.13 fa:16:3e:d5:e0:14 10.0.3.5 fa:16:3e:f3:ea:4c 10.0.1.4 fa:16:3e:ed:05:e4 T0 (on switch) frame",
  "29": "\u2022 If T2 does not have info of a particular ip-address o N2 broadcasts an ARP request packet to all devices on the local network. o The request essentially asks, \" Who has IP address X.X.X.X? Tell me your MAC address .\" \u2022 The device with the requested IP address receives the ARP request and reply with an ARP reply packet. o This reply includes the sender's IP address and corresponding MAC address. o Upon receiving the ARP reply, the requesting node updates its ARP table with the new IP-to-MAC address mapping. \u2022 Any node, say N1, can also broadcast the info or to a specific node, even if there isn\u2019t such a request (reply with out a request). ARP Table Update Vulnerable?",
  "30": "\u2022 N 1 informs N 2 that mac address of 10.0.1.4 (i.e., N3's)  is fa:16:3e:d5:e0:14 (i.e., N1's) o N3's IP => N1 mac o 10.0.1.4 => fa:16:3e:d5:e0:14 fa:16:3e:d5:e0:14 \u2022 N 1 informs N 3 that mac address of 10.0.3.5 (i.e., N2's) is fa:16:3e:d5:e0:14 (i.e., N1's) o N2's IP => N1 mac o 10.0.3.4 => fa:16:3e:d5:e0:14 fa:16:3e:d5:e0:14 Attack:  N 1 wants to be MITM between 10.0.3.5 and 10.0.1.4 Switch Ip-address p-address -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.1.4 fa:16:3e:ed:05:e4 Switch\u2019s port port ort Mac-address 1 fa:16:3e:d5:e0:14 2 fa:16:3e:f3:ea:4c 3 fa:16:3e:ed:05:e4 T2 T3 Ip-address p-address -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.3.5 fa:16:3e:f3:ea:4c N 1 1 N 2 2 N 3 3 10.0.3.13 fa:16:3e:d5:e0:14 10.0.3.5 fa:16:3e:f3:ea:4c 10.0.1.4 fa:16:3e:ed:05:e4 N3 IP => N1 Mac address N2 IP => N1 Mac address fa:16:3e:d5:e0:14 fa:16:3e:d5:e0:14 T0 Poisoned?",
  "31": "\u2022 After the tables are poisoned ,  all frames will be sent to N 1 . \u2022 N1 can relay the frames, or modify 1 can relay the frames, or modify can relay the frames, or modify the frames before relaying. \u2022 Hence, N1 become the MITM in 1 become the MITM in become the MITM in layer 2. \u2022 Similar when N3 sends frames to fa:16:3e:d5:e0:14 N2 When N 2 want to send to IP address 10.0.1.4 Switch Ip-address p-address -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.1.4 fa:16:3e:ed:05:e4 Switch\u2019s port port ort Mac-address 1 fa:16:3e:d5:e0:14 2 fa:16:3e:f3:ea:4c 3 fa:16:3e:ed:05:e4 T2 T0 T3 Ip-address p-address -address Mac-address 10.0.3.13 fa:16:3e:d5:e0:14 10.0.3.5 fa:16:3e:ed:05:e4 N 1 1 N 2 2 N 3 3 10.0.3.13 fa:16:3e:d5:e0:14 10.0.3.5 fa:16:3e:f3:ea:4c 10.0.1.4 fa:16:3e:ed:05:e4 fa:16:3e:d5:e0:14 fa:16:3e:d5:e0:14 frame frame",
  "32": "Denial of Service Attack 6",
  "33": "\u2022 Attempt to disrupt the normal functioning of a targeted server, service, or network => effect availability \u2022 Many successful DoS attacks simply flood the victims with overwhelming requests/data. \u2022 For DoS to be effective, large number of attackers are required o A single attacker can send requests only at a low rate \u2022 When DoS is carried out by a large number of attackers, this is called DDoS: Distributed Denial of Service Denial-of-Service (DoS) Attacks",
  "34": "\u2022 A type of DoS in which the attackers send requests to intermediate nodes, which in turn send overwhelming traffic to the victim . \u2022  Attacker spoofs the victim\u2019s IP address as the source. \u2022 The intermediate nodes then sends its response back to the spoofed IP (the victim) \u2022 Indirect, and thus more difficult to trace. Reflection Attack",
  "35": "\u2022 An attacker sends the request  \u201c ICMP PING \u201d to a router, instructing the router to broadcast this request. o The source ip-address of this request is spoofed with the victim ip address. \u2022 The router broadcasts this request. \u2022 Each entity who has received this request, replies to it by sending an \u201cecho reply\u201d to the source , which is the victim. \u2022 The victim\u2019s network is overwhelmed with the \u201cecho reply\u201d. Reflection Attacks: ICMP/Smurf flood",
  "36": "Attacker Router Reflection Attacks: ICMP/Smurf flood Devices Router, please broadcast this message to everyone \u201cReply to me. My address is Victim IP\u201d Devices Devices Victim Echo reply Reply redirected to victim Echo request packet with spoofed IP Request Response Response",
  "37": "\u2022 Most router are now configured not to broadcast by defaults. o This attack is no longer effective. \u2022 Configure firewalls to block incoming ICMP Echo Request packets directed at broadcast addresses. Smurf Flood Preventive Measure",
  "38": "\u2022 A variation of reflection attacks where the intermediate nodes response is significantly larger than the attacker\u2019s request. o its amplification factor, which is the size of traffic the victim received over the size of traffic sent by the attacker. \u2022 A single request could trigger multiple responses from the intermediate nodes. \u2022 This difference in request-versus-response size \u201camplifies\u201d the traffic directed at the victim. Amplification Attack",
  "39": "DDoS Amplification Attack high bandwidth amplification factor \u2026 Amplifiers (e.g., DNS resolvers, NTP servers) Attack Requests flooding with 100s Gbps attack bandwidth Target Network with IP 0 \u2026 IP-spoofed bots (compromised machines - botnet) Upstream Network Attack Responses \u2022 Exploit UDP services (e.g., DNS, NTP) to amplify a relatively small volume of traffic into a larger volume",
  "40": "Securing Different Layers 7",
  "41": "\u2022 In the past lectures, we have illustrated that cryptography techniques can be deployed to achieve confidentiality and authenticity over a public communication channel, even if the adversary can sniff & spoof data. \u2022 There are many security protocols achieving that but operates at different \u201clayers\u201d. \u2022 The well-known TLS/SSL, WPA, IPSEC  protect different layers. Securing the Communication Channel",
  "42": "\u2022 The SSL/TLS  sit on top of Transport layer. \u2022 When an application (say browser) wants to send data to the other end point, it first passes the data and the address (ip address, port) to SSL/TLS. \u2022 Next SSL/TLS first \u201cprotects\u201d the data using encryption and mac. 1. SSL/TLS Application (e.g., https) Transport (e.g., TCP/UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical Application (e.g., https) Transport (e.g., TCP/UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical SSL/TLS SSL/TLS Source IP-address Destination IP-address Source Port Destination port Application data Encrypted and authenticated Src mac Dest mac",
  "43": "http data Encrypt + mac http data TLS header IP header Data link header Application (e.g., https) Transport (e.g., TCP/UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical SSL/TLS Encrypt + mac http data TLS header TCP header Encrypt + mac http data TLS header TCP header IP header Encrypt + mac http data TLS header TCP header Alice uploads a report to Canvas The receiver end-point decrypts the received data at the corresponding layer. 1. SSL/TLS: Example Attacker at physical layer. (able to sniff and spoof) => MITM Can attacker know Alice is visiting Canvas website ?",
  "44": "\u2022 IPSec is a mechanism whose goal is to protect the IP layer - secure all IP traffic between endpoints \u2022 Securing network connections between host-to-host, network- to-network (gateways) or network-to-host ( gateway and host) 2. Internet Protocol Security (IPSec) Application (e.g., https) Transport (e.g., TCP/UDP) Layer 3 IPSec Layer 2 Data Link Layer 1 Physical Source IP-address Destination IP-address Source PortEncrypted and AuthenticatedDestination port Destination port Application data Encrypted and AuthenticatedDestination port Src mac Dest mac",
  "45": "\u2022 A popular protocol to protect data transmitted over Wi- Fi networks \u2022 WPA2 provides protection in  layer 2 (Link) and layer 1 (Physical). o data traveling between a wireless device and the access point is confidential and protected from eavesdropping. \u2022  Not all information in layer 2  are protected. 3. Wi-Fi Protected Access II (WPA2) Application (e.g., http) Transport (e.g., TCP/UDP) Layer 3 Network (aka IP) Layer 2 Data Link (WPA) ) Layer 1 Physical Source IP-address Destination IP-address Source Port Destination port Application data Encrypted and authenticatedSource Port Src mac Dest mac",
  "46": "\u2022 Enable remote user to securely connect to private network \u2022 First, VPN client and the VPN server establish a connection, which is called a \u201ctunnel\u201d => authentication and verification done, establish session keys. \u2022 While Alice communicating with another node, say Bob,  the VPN client encrypt the entire payload  and add a new IP header \u2022 From Bob\u2019s point of view, Alice is communicating with the virtual node with ip-address in NUS. (Thus, not knowing Alice actual IP address). 4. Virtual Private Network (VPN) Application (e.g., https) Transport (e.g., TCP/UDP) Layer 3 Layer 2 Data Link Layer 1 Physical VPN Client Application (e.g., https) Transport (e.g., TCP/UDP) Layer 3 Layer 2 Data Link Layer 1 Physical VPN Server tunnel Alice SoC VPN Server Source IP-address Destination IP-address Source Port Destination port Application data IP header Src mac Dest mac",
  "47": "\u2022 The \u201ctunnel\u201d can be established in many ways. o Use TLS/SSL or use IPSec \u2022 Since layer 3 & 4 are often treated as one,  if the client is in layer 4,  many documents still say that it is  in layer 3, and call it Layer 3 VPN. \u2022 There are many different configurations and variants. o E.g., for efficiency, some VPN clients might choose not to tunnel DNS queries. 4. VPN",
  "48": "\u2022 From the previous, it seems that by protecting the lowest layer, we can protect information in all layer \u2013 not feasible \u2022 Why? o Intermediate node need to access some higher layer info, e.g., ip-address, and sit in higher layer. o Hence, a malicious intermediate node could be a MITM in higher layer. \u2022 Typical implementation use TLS/SSL  +  WPA2 \u2022 IPSec turns out to be expensive to implement and difficult to deploy. Which Layer Should We Protect?",
  "49": "Which Layer Should We Protect? Alice Laptop Home WiFi Switch \u2026 Gateway (e.g., Modem from Singtel) Data Centre Gateway bbc server WPA2 Network level (IPSec), Transport level (TLS) Simplified",
  "50": "Firewalls and IDS 8",
  "51": "\u2022 Consider the computer network in an organization. \u2022 Some nodes contain more sensitive information than other. o Example, Student examination record database server,  vs  public workstations in lecture hall. \u2022 Some nodes are more \u201csecure\u201d . o E.g., When a patch is available, it might take some time (e.g., days, weeks, months) to patch all the systems and need to be prioritized. o E.g., Certain nodes operate in a more hostile environment, lecture theatre\u2019s workstation. Motivation",
  "52": "\u2022 We need to divide the computer network into segments and deny unnecessary access. o Principle of least privilege: control access to the network. o Compartmentalization : Keep things separated to limit the impact of any single failure or attack. \u2022 Tools to control access to the network. o Firewall : is a gatekeeper, prevents unauthorized access o Intrusion detection system (IDS): is a watcher that raises alerts by monitoring and analysing Motivation",
  "53": "\u2022 A Firewall controls what traffic is allowed to enter the network ( ingress filtering) or leave the network ( egress filtering). o Firewall are devices or programs that control the flow of network traffic between networks or hosts that employ differing security postures. (from Guidelines) ) \u2022 DMZ: Demilitarized zone o A sub-network that exposes the organization\u2019s external service to the (untrusted) Internet. o Separates an internal local area network (LAN) from untrusted external networks, usually the Internet. o Its purpose is to add an extra layer of security to an organization\u2019s internal network. \u2022 DMZs are created using firewalls Firewall and DMZ",
  "54": "\u2022 Internet : untrusted \u2022 Front-end-firewall : control incoming/outgoing traffic to DMZ \u2022 DMZ : public facing servers accessible from the Internet \u2022 Back-end firewall : Only specific traffic is allowed from the DMZ to the internal zone \u2022 Internal network : Highly trusted area where critical server are present. A typical 2-firewall setting Firewall1 Database server Internet Firewall2 Web server DMZ Mail Server Internal network Front-end firewall Back-end firewall Usually red Usually green Usually purple",
  "55": "\u2022 If a web/mail server in the DMZ is compromised, the attacker still has to bypass the back-end firewall to reach sensitive data. \u2022 The two-firewall model ensures defense in depth : o One firewall (front-end) restricts external access. o Another firewall (back-end) restricts access to the internal network. A typical 2-firewall setting",
  "56": "A typical 2-firewall setting. Firewall1 Database server Internet Firewall2 Web server DMZ Mail Server Internal network Front-end firewall Back-end firewall Usually red Usually green Usually purple Very often, the two firewalls residue in a single hardware/router",
  "57": "\u2022 Firewall\u2019s controls are achieved by \"packets filtering\" (aka screening). o Filtering may occur in router, gateway/bridge, host, etc. \u2022 Packet filtering inspects every packet, typically only on the TCP/IP packet\u2019s header information (network & transport layer). \u2022 If the payload is inspected , we call it deep packet inspection (DPI) . \u2022 Action taken after inspection could be o Allow the packet to pass o Just drop the packet o Reject the packet (i.e., drop and inform the sender) o Log info o Notify system admin o Modify the packet (for more advanced device). Packet filtering / Screening (link) link) )",
  "58": "\u2022 Drop packets with \u201csource ip-address\u201d not within the organization\u2019s network. This can stop attacks originated within the network \u2022 Whitelist o Drop all packets except those specified in the white-list. (e.g., drop all except http, email protocol, and DNS) \u2022 Blacklist o Accept all packets except those specified in the black-list.  (e.g., allow https except ip-address in the blacklist). Example of firewall rules",
  "59": "\u2022 The rules are processed sequentially starting from rule 1, 2, \u2026. The first matching rule determines the action. \u2022 The symbol \u201c*\u201d  matches any value. This is a symbol in \u201cregular expression\u201d. Example Rule Rule Type Direction Source Address Destination Address Designation Port Action 1 TCP in * 192.168.1.* 25 Permit 2 TCP in * 192.168.1.* 69 Permit 3 TCP out 192.168.1.* * 80 Permit 4 TCP in * 192.168.1.18 80 Permit 5 TCP in * 192.168.1.* * Den y 6 UDP in * 192.168.1.* * Den y Matching condition action",
  "60": "\u2022 NIST\u2019s  document  (NIST 800-41) groups the firewalls into 3 types: 1. Packet filters. o Inspect only the header. (mainly IP packet\u2019s header). o Use : Blocking traffic from certain IP or port 2. Stateful Inspection. o Keep a state on previously received  packets. o E.g., counting number of connection a particular IP address has made in the past one hour. o Use : Blocking abnormal connection pattern or unauthorized session attempts. 3. Proxy. o Act as intermediaries that fully receive, inspect, and forward (possibly modify) packets between client and server. o Use : block certain URLs or scan for malware in HTTP traffic Types of firewall",
  "61": "\u2022 An IDS is a security tool or software that monitors computer systems and networks for signs of o malicious activity, policy violations, or security breaches. \u2022 An IDS system consists of a set of \u201csensors\u201d that gather data such as logs, network packets, etc. o Sensors can be deployed on hosts, or network router. \u2022 The data are analyzed for intrusion either in real-time or after collection to detect suspicious patterns, attacks, or abnormal behaviour. Intrusion Detection System (IDS)",
  "62": "\u2022 Attack Signature Detection o Looks for specific, well-defined patterns or \u201csignatures\u201d of known attacks in the data collected by sensors. o For e.g., using certain port number, certain source ip address. \u2022 Anomaly Detection o The IDS attempt to detect abnormal pattern that deviate from the established \u201cnormal\u201d behaviour of the network o For e.g., a sudden surge of packets with certain port number. \u2022 Behavior-based IDS o Can be viewed as a type of anomaly detection that focuses on human behavior. o For e.g.  The system might keep the profile of each user and detect any user who deviates from the profile (e.g., start to download large files). Three types of IDS",
  "63": "\u2022 Crypto + PKI can provide confidentiality & authenticity even in the presence of MITM. \u2022 Routing . o Layering . Intermediate nodes need to see and modify routing info at different \u201clayers\u201d. o Protection at different layers.  MITM in different layers. \u2022 Some specific attacks: o DNS spoofing, DoS, ARP table poisoning . \u2022 Popular protocols: SSL/TLS (application),   IPSEC (network),   WPA2 (link) \u2022 Firewalls and IDS \u2022 Tools :  Wireshark, nmap, nslookup. Summary",
  "64": "Explore On Your OWN: Useful Tools",
  "65": "\u2022 Wireshark:  a free open-sourced packets analyzer. :  a free open-sourced packets analyzer. \u2022 Exactly what does wireshark capture? \u2022 Wireshark listens to \u201cinteractions\u201d between the OS and the network card driver.  (In other words, it is a MITM between OS and network card). \u2022 Hence, header added by the network card, or modification made by the network card, may not be captured by Wireshark.  This depends on the OS and the hardware. 1. Wireshark (packets analyzer) - Demo Application (e.g., https) Transport (e.g., TCP, UDP) Layer 3 Network (aka IP) Layer 2 Data Link Layer 1 Physical Typically capture in this layer.",
  "66": "\u2022 Wireshark \u2013 capture, interface, mac address \u2022 Display filter \u2022 Expand each packet \u2013 various part o TCP o TLS handshake o DNS o ARP o HTTPs \u2013 application data Try Out",
  "67": "\u2022 Port scanning: The process of determining which ports are open in a network. \u2022 Port scanner: A tool for port scanning.  E.g., Nmap. \u2022 Port scanner is a useful tool for attacker, and network administrator to scan for vulnerabilities. \u2022 Is port scanning illegal? \u2022 (Read if you want to use it) https://nmap.org/book/legal-issues.html 2. Nmap (port scanning)",
  "68": "2. Nmap (port scanning) Example",
  "69": "\u2022 Netwox provides a wide range of network utilities and tools for testing, monitoring, and manipulating networks. \u2022 You can run a command like following (the parameters depend on which tool you are using) : $ sudo netwox number [parameters ... ] \u2022 For some of the tool, you have to run it with the root privilege. \u2022 If you are not sure how to set the parameters, you can look at the manual by issuing \"netwox number --help\". 3. Netwox tool tool"
}