{
  "1": "Lecture 6: Web Security 6.1 Background 6.2 Vulnerabilities in the \u201csecure\u201d channel 6.3 Mislead the user (address bar) 6.4 Cookies and same origin policy 6.5 Cross-site scripting (XSS) 6.6 Cross-site request forgery see [PF] 4.1, 4.2, 4.3",
  "2": "Summary & takeaway \u2022 Web (HTTP) is in the \u201capplication\u201d layer. It is a popular platform with many services built on top of it. \u2022 HTTPS =  HTTP  on top of TLS.    (inherit strength & weakness of TLS). \u2022 The mechanism of cookies. \u2022 Cookies might contain authentication credential (authentication) and personal information (privacy). \u2022 Browser interacts with multiple sites, each site with its cookies.  Need separation among different sites.  Access control boundary between sites based on same-source-origin .  Unfortunately, turn out that the separation is weak (ambiguity, difficult for users to visually double-check, etc). \u2022 XSS.   XSRF. \u2022 Script injection. \u2022 Human-in-the-loop.  (confusing URL and address bar). 2",
  "3": "6.1 Background &seqNum=3 3",
  "4": "Overview 1. User clicks on  a \u201clink\u201d. e.g www.nus.edu.sg e.g www.nus.edu.sg www.nus.edu.sg 2. A http request is sent to the server.  (with cookie c0 if any) (with cookie c0 if any) 0 if any) if any) 3. Server constructs and sends a \u201chtml\u201d file to the browser, possibly with a cookie c1 1 (the cookie can be viewed as some information the server wants the browser to keep, which to be passed to the server during the next visit. The cookie can be some secrets). . 4. The browser renders (including running of script)  the html file.   The html file describes the layout to be rendered and presented to the user, which could include scripts.  The html file also instruct the browser to update the cookies. In Firefox, right-click, choose \u201cview page source\u201d to view the html file that is sent from the server to the browser. (or Tool->Wed Developer->Toggle tool) In Chrome, View->Developer->View Source    (or View->Developer->Developer tool) 4 Client-side Server-side Browser OS Server (website) backend server (2) http request, c0 0 (3) html, c1 1 (1) click (4) render (including running scripts in the html file)",
  "5": "Closer look into an example. 1) Browser visits Google page.   A html file H is sent to the browser. The browser renders H.    (Try viewing the raw form of H. In chrome, view->developer->view source.    Note that (Try viewing the raw form of H. In chrome, view->developer->view source.    Note that there are many occurrences of  the keyword  \u201c<script>\u201d which marks the beginning of a script.) 2) User enters the keywords \u201cCS2017 NUS\u201d 3) The browser, by running scripts in H,  constructs a query Q. https://www.google.com.sg/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=CS2107+NUS 4) Browser sends query Q  to Google. - Note that additional information is added as parameters in Q. These info is useful  for the server. The info could even be in the form of script. 5) The server constructs a reply. (in some cases, the reply contain substrings in (3)). (in some cases, the reply contain substrings in (3)). 5 browser Server (1) H (2)+(3) (4) Q (5) reply",
  "6": "6 Right click, Choose \u201cinspect\u201d",
  "7": "Complications of Web Security. \u2022 In many OS\u2019es, browsers run with the same privileges as the user. Hence, the browser can access the user\u2019s files. (note: this is not the case in Android). (note: this is not the case in Android). \u2022 Browsers support a rich commands/controls set  for content providers to render the content. \u2022 Browsers manage sensitive user\u2019s info and secrets  (stored in cookies). \u2022 At any one time, there could be many servers providing the content in the browser ( ( e.g. different advertisements appear at the same time) \u2022 For enhanced functionality, many browsers support add-ons, plugins, extensions by third parties. (definitions and differences of add-ons, plugins, extensions are not clear and depends on the browsers.) \u2022 Users upload info to the server (e.g. forum, names to be displayed). \u2022 More and more sensitive data information is in the web/cloud. For desktop, browser is becoming the main application.  (Situation slightly different in mobile os where users also (Situation slightly different in mobile os where users also interact with the web using \u201capps\u201d.) 7",
  "8": "Threat model 1: Attackers as another end systems. Here, the attacker is just another end system. For e.g. a malicious  web-server that the victim is lurked to visit,  or  attackers who has  access to the targeted server. 8 Browser OS Client-side Server-side Server (web-site) backend server malicious server, URL malicious client",
  "9": "Threat model 2: Attackers as MITM. Here, the attacker is a Man-in-the-middle in the IP or lower layer.  The attacker can gain MITM in a few ways, for e.g., \u2022 As the caf\u00e9-owner who provides the free wifi; \u2022 Via DNS spoofing attack or ARP attack; \u2022 As owner of the VPN server, last hop in the TOR network (not covered in this module). (not covered in this module). . Because the MITM is in the IP layer, the MITM can attempt to impersonate a server (e.g. phishing attack). So, this threat model also covers some settings of threat model 1 where the attacker is the server. 9 Browser OS Client-side Server-side Server (web-site) backend server MITM We had covered this threat model  in previous lectures.",
  "10": "6.2 Vulnerability in the secure communication channel  (SSL/TLS) &seqNum=3 10 HTTPS =   HTTP on top of SSL/TLS",
  "11": "Recap \u2022 Recap : HTTPS considers threat model 2, i.e. a MITM in the IP layer.  HTTPS is \u201csecure\u201d in this model. This is achieved by TLS  (securing the channel using combination of crypto primitives and authentication protocol) and PKI (securing the channel using combination of crypto primitives and authentication protocol) and PKI and PKI (securing distribution of public key). . \u2022 Recap : From a user\u2019s perspective, the presence of padlock and correct domain name in the address bar assure that the browser is indeed interacting with the authentic server. (hence not under phishing attack). \u2022 However, the above assumes that the system is designed  and implemented correctly. \u2022 A number of examples: Superfish (not covered in this year), Re-negotiation attack (tutorial), Freak attack (not covered in this year), Re-negotiation attack (tutorial), Freak attack , Re-negotiation attack (tutorial), Freak attack (not covered in this year), BEAST attacks (similar to padding oracle) (not covered in this module). , BEAST attacks (similar to padding oracle) (not covered in this module). (not covered in this module). 11",
  "12": "6.3 Misleading user on domain name &seqNum=3 12",
  "13": "URL (Uniform Resource Locator) A url consists of  a few components. (see https://en.wikipedia.org/wiki/Uniform_Resource_Locator) (see https://en.wikipedia.org/wiki/Uniform_Resource_Locator) 1. scheme, 2. authority (a.k.a  the hostname) , 3. path 4. query 5. fragment e.g. http://www.wiley.com/WileyCDA/Section/id- ://www.wiley.com/WileyCDA/Section/id- www.wiley.com/WileyCDA/Section/id- /WileyCDA/Section/id- WileyCDA/Section/id- 302477.html?query=computer%20security#12 ?query=computer%20security#12 query=computer%20security#12 #12 12 Question: Why the url is typically displayed using two levels of intensity? 13",
  "14": "Source of confusion\u2026 \u2022 A malicious website may register a hostname that contains the targeted hostname with a character that resembles the delimiter \u201c/\u201d www.wiley.com.66785689.in/Section/id-302477.html The different intensities could help user to spot the attack. e.g. from phishing email: nuslogin.789greeting.co.uk 14 http://www.wiley.com/WileyCDA/Section/id-302477.html?query=computer%20security Hostname path Visually, no clear distinction of \u201cHostname\u201d and \u201cpath\u201d. The delimiter \u201c/\u201d can appear elsewhere, which confuses viewers.",
  "15": "\u2022 The browser Safari chooses to display the hostname *only* in the address bar. 15",
  "16": "Address bar spoofing \u2022 Address bar is an important component to protect.  The address bar is the only indicator of which url the page is rendering.  If the address bar can be \u201cmodified\u201d by the webpage, an attacker could trick the user to visit a malicious url X , while making the user to falsely believe that the url is Y . \u2022 A poorly-designed browser may allow attacker to achieve that.  E.g. in early design of some browsers, a web page could render objects/pop-up in arbitrary location, and thus allowing a malicious page to overlay  spoofed address bar on top of the actual bar.  Current version of popular browser have mechanisms to prevent that. \u2022 See a more recent e.g.: Android Browser All Versions - Address Bar Spoofing Vulnerability - CVE- 2015 - 3830 http://www.rafayhackingarticles.net/2015/05/android-browser-address-bar-spoofing-vulnerability.html 16",
  "17": "6.4 Cookie and Same-origin policy Remark:     Many websites get users\u2019 consents to keep cookies.  Why is this so? EU\u2019s  GDPR (General Data Protection Regulation). https://www.cookiebot.com/en/gdpr-cookies/ 17 Browser OS Server (web-site) backend server (2) http request, c0 0 (3) html, c1 1 (1) click (4) render (including running scripts in the html file)",
  "18": "Cookies \u2022 A http cookie is a piece of data sent by the server in the response of a HTTP request. It is under the \u201cSet-Cookie\u201d header field.  The browser permanently stores the cookie. \u2022 Whenever a client revisits the website, the browser automatically sends the cookie back to the server. Remarks: \u2022 The cookies are sent back only to the \u201csame origin\u201d, in the sense that, it is sent to the server which is the \u201corigin\u201d of the cookie.   Viewing from access control perspective,  the \u201csame origin\u201d set the boundary among different web sites.  A script from a web site can only access cookies within its boundary. (unfortunately, this is not done clearly, leading to many problems\u2026) \u2022 There are also a few types of cookie, eg. session cookies (deleted after the session ends), secure cookies (can only be transmitted over https), etc.  See https://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie https://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie 18",
  "19": "Demo on Firefox \u2022 right-click -> view page info -> security -> cookie \u2022 Tools -> web developer -> Developer toolbar 19",
  "20": "Same-Origin Policy A \u201cscript\u201d which runs in the browser could access cookies. Which scripts can access the cookie?   Due to security concern, browser employs this access control policy: The script in a web page A (identified by URL) can access cookies stored by another web page B (identified by URL), only if both A and B  have the same origin. Origin is defined as the combination of protocol,  hostname, and port number. The above access policy is  simple and thus seeming safe.  However, there are several complications. 20",
  "21": "Definition of \u201csame-origin\u201d. Example (from http://en.wikipedia.org/wiki/Same-origin_policy  ) (from http://en.wikipedia.org/wiki/Same-origin_policy  ) URL\u2019s with the same origin as: http://www.example.com 21 Limitations: \u2022 Confusing definition : There are many  exceptions, and exceptions of exceptions. Very confusing and thus prone to errors. \u2022 Different browsers may adopt different definitions.",
  "22": "E.g. of  Cookie application: Token-based authentication Cookie is useful.  Here is one application for Single-Signed-On. (This example appeared in the tutorial on renegotiation attack) To ease user tedious task of repeated login, many websites use \u201ctoken- based\u201d authentication.    That is, 1. After a user A is being authenticated (for e.g. password verified), the server sends a value t , know as token, to the user. 2. In subsequent connection, whoever presents the correct value is accepted as the authentic user A .  (note that user does not has to perform the (note that user does not has to perform the tedious password authentication again). Remarks \u2022 Token typically has  an expiry date. \u2022 An identification of the session can be used as the token. So the token is also called SID. \u2022 In web applications, the token is often stored in the cookie. 22",
  "23": "(1) Authentication challenge (e.g. asking for password). (2) Authentication Response that involves the user. (3) Server sends a token t. Browser keeps the token (4) Browser presents the token t. Server verifies the token. We assume that the communication channel is secure. (i.e. all communication over HTTPS (with server authenticated) and the HTTPS is free from vulnerabilities). 23 Browser Server (1) (1) (2) (2) (3) (4) Subsequent authentication sessions First authentication session token t token t token t",
  "24": "Choices of token \u2022 Suppose t is a randomly chosen number, then the server needs to keep a table storing all the tokens it has issued. To avoid storing the table, one could use \u2022 (secure version) A message authentication code (MAC). The token t consists of two parts: a randomly chosen value, or meaningful information like the expiry date, concatenated with the mac computed  using the server secret key. e.g t =    \u201calicetan:16/04/2015:adc8213kjd891067ad9993a\u201d \u2022 (insecure version) the cookie is some meaningful information concatenated with a sequence number that can be predicted. e.g   t= \u201calicetan:16/04/2015:128829\u201d \u2022 For both methods, when the server finds out that the token is not in the correct format (or not the correct mac), the server rejects. The first method relies on the security of mac,  while the second method relies on obscurity \u2013 attackers don\u2019t know the format. \u2022 The second method is insecure because an attacker,  who knows how the token is generated (for (for e.g. by observing its own token), can forge it. This further illustrates the weakness of security by , can forge it. This further illustrates the weakness of security by obscurity. 24",
  "25": "6.5 Cross Site Scripting (XSS) Attacks &seqNum=3 25",
  "26": "Background In some  websites, if the browser sends a text that contains a substring s, the replying html sent by the server would also contain the same substring s. 26 \u2022 Enter a wrong address. http://www.comp.nus.edu.sg/nonsense_test \u2022 Search for a book in library http://nus.preview.summon.serialssolutions.com/#!/search?q=heeheeheee \u2022 What if the string s contains a script? e.g. http://www.comp.nus.edu.sg/ <script>alert(\u201cheehee!\u201d);</script> (the above attack won\u2019t work as the server replaces the special character \u201c<\u201c by &lt)",
  "27": "Attack 1. Attacker tricks a user to click on an url, which contains the target website, and a malicious script s. e.g the link could be sent via email with \u201cclick me\u201d, or a link in a malicious website. 2. The request is sent to the server. 3. The server constructs a response html. The response contains the script s . 4. The browser renders the html page and runs the script s 27 click me the url of \u201cclick me\u201d contains a script s (1) browse r targete d website (2) (3) (4) browser runs the script  s",
  "28": "why this is an attack? The malicious script could 1. deface the original webpage; 2. steal cookie. \u2022 The control that protects access to the cookie is the same-origin policy. \u2022 Now, since the malicious script is coming from the same-origin (the victim clicked on it..), it can Now, since the malicious script is coming from the same-origin (the victim clicked on it..), it can (the victim clicked on it..), it can , it can now access cookie previously sent by the website. \u2022 This is yet another example of privilege escalation . A malicious script has elevated privilege to read the cookie. This attack exploits the client\u2019s trusts of the server. 28",
  "29": "types of XSS \u2022 Reflection (aka non-persistent).  The attack described before. \u2022 Stored XSS (aka persistent). The script Stored XSS (aka persistent). The script s is stored in the targeted website.   For instance, in forum page. 29",
  "30": "Defense \u2022 Most defense rely on input-validation carried out by the server.  That is,  the server filters and removes malicious script in the request while constructing the response page. However, this is not a fool proof method. 30",
  "31": "6.6 Cross Site Request Forgery (XSRF) &seqNum=3 31",
  "32": "\u2022 Aka \u201csea surf\u201d, cross-site reference forgery, session riding. \u2022 This is the reverse of XSS.  It exploits the server\u2019s trust of the client. Previous attack of XSS exploits the client\u2019s trust of the server. Example: \u2022 Suppose a client A is already authenticated by a targeted website S, say www.bank.com and the site keeps a cookie as \u201ctoken\u201d. \u2022 The attacker B tricks A to click on a url of S.  The url maliciously requests for a service, say transferring $1000 to the attacker Bob\u2019s www.bank.com/transfer?account=Alice&amount=1000&to=Bob \u2022 The cookie will also be automatically sent to S which is sufficient to convince S that A is already being authenticated. Hence the transaction will be carried out. See https://en.wikipedia.org/wiki/Cross-site_request_forgery 32",
  "33": "Defense Relatively easier to prevent compared to XSS. Include authentication information in the request. For e.g. www.bank.com/transfer?account=Alice&amount=1000&to=Bob& Token=xxk34n890ad7casdf897e324 33",
  "34": "6.7 Other Attacks Misconfiguration, searching for filename\u2026 &seqNum=3 34",
  "35": "Other attacks and terminologies \u2022 Web tracking \u2022 Web bug (aka web beacon, tracking bug, tag, page tag). \u2022 Legitimate usage, PDPA. (why websites keep getting consensus from user on cookies usage?) \u2022 Drive-by-Download. \u2022 Pixel stealing. . (steal the pixel value on the display) \u2022 Clickjacking, User Interface redress attack Clickjacking, User Interface redress attack (trick the user to click on attacker overlayed GUI) https://www.owasp.org/index.php/Clickjacking \u2022 CAPTCHA CAPTCHA \u2022 Click fraud (robots that click on advertisement) Question:   Could merely visiting a malicious web-site  (for e.g. wrongly clicked on a phishing email) subjected to attack? 35",
  "36": "Common simple implementation mistakes \u2022 Authentication/filtering  at the client side. \u2022 Security credential  embedded in the public web pages. \u2022 Server\u2019s secrets stored in cookies. \u2022 Configuration errors. \u2022 URL as secrets, e.g. in password reset link, or zoom link.  This is acceptable and commonly used. However, some implementations do not have adequate protection or unknowingly leak info of the url. 36",
  "37": "37 https://motherboard.vice.com/en_us/article/43yqdd/look-at-this-massive-click-fraud-farm-that-was-just- busted-in-thailand",
  "38": "Wireshark Demo Additional slides for network security",
  "39": "(1) Choose the \u201cnetwork interface\u201d (2)  Set a capture filter if required. e.g  simply leave it empty  or \u201ctcp\u201d This interface  ip-address Is 192.168.50.183. Its mac address (not shown in this screenshot) Is 78:4f:43:8b:47:aa",
  "40": "(3) Too many info.   Use  the display filter to select what to see.  Note the difference between display and capture filter. (4) Click here to see various options for display filter. (4) Use this to start and stop capture, change interface.",
  "41": "Display filter.",
  "42": "ARP:   What is in the frame 5168 and 5169? Expand this to see more details. Actual byte values in hexdecimals. What is \u201cff ff ff ff ff ff\u201d, and \u201c64 1c b0 45 eb 96\u201d? Actual byte values in ASCII format.",
  "44": "Let\u2019s look at DNS.   (set the display filter to \u201cdns\u201d) Concurrently,  I issued an \u201cnslookup\u201d command.     See 5595 and 5598.",
  "47": "Set display filter to \u201cssl\u201d.   Find the  TLS handshake (authenticated key exchange). E.g. on SSL/TLS",
  "48": "Encrypted data",
  "49": "Looking at all IP packets from the ip.adder 103.1.139.51 Note that at TCP layer, there are many other more interactions (3 way-handshake, the \u201cACK\u201d etc). Details not required in this module.",
  "50": "We can use nslookup to find out more about an ipaddress. (known as reverse DNS lookup. It finds the domain name from ip-address.)  We can also find the geolocation by using some services from the web.  Does not always work.",
  "51": "There are many more tools and features.  (e.g. the \u201cfollow\u201d, \u201cAnalyze\u201d, \u201cexport\u201d etc) Explore to find out more."
}