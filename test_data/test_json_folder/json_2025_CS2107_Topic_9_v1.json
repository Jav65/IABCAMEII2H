{
  "1": "Next Week \u2022 Exam briefing.   Summary/Review. \u2022 Demo of cybersecurity kill-chain on a virtual enterprise system by \u2022 Shen Jiamin \u2022 Arshdeep Singh Kawatra 0",
  "2": "Topic 9: Access Control 9.1  Access Control model 9.2  Access Control Matrix 9.3  Intermediate control 9.4  Unix 9.5  Elevated privilege  and controlled invocation 9.6*   Controlled invocation in Unix see [PF] Chapter 2.2 (pg 72 \u2013 85) see [Andersen] Chapter 4 up to 4.2.4 read wiki  http://en.wikipedia.org/wiki/File_system_permissions *: These steps are complicated. Complexity is bad for security. see https://www.schneier.com/news/archives/2012/12/complexity_the_worst.html \u201c Does TikTok access the home Wi-Fi network ?\u201d - Senator to Shou 1 Change log  v1: 1. Slide 48. Correct the arrows. 2. Improving presentation here and there. 3. Remove references ([pf]) to the reference book.",
  "3": "Summary & takeaways \u2022 How access control is specified: operation, objects, subjects (principle). Access Control Matrix, Intermediate control to simplify representation.  Examples of intermediate control. Representation: ACL vs Capability. \u2022 Guideline. Security perimeter, security boundary, principle of least privilege, segregation, compartment, segmentation, firewall. \u2022 How to share info across security perimeter: \u201cBridge\u201d  and \u201cprivilege elevation\u201d (aka \u201cprivilege escalation\u201d in the (aka \u201cprivilege escalation\u201d in the context of attack). . 2 Example in Unix. o File system: ACL.   Intermediate control (user, group, world). o Objects :  program, resources (e.g keyboard, display, network) treated as files. o Subjects : processes.  Each process  has  (1) real uid , specifying its owner (principle)  (2) effective uid that is used by the reference monitor to check permission. o Operations : read, write, execute. o Ring: root (0) vs user(1). o Example of  \u201cbridge\u201d. Example:  Apps in Android  vs  Users in Linux/Window",
  "4": "9.1 Access Control model Access control model is relevant in many systems. E.g. \u2022 File system  (which files can a user read), File system  (which files can a user read), (which files can a user read), , \u2022 Canvas         (who can upload files), Canvas         (who can upload files), (who can upload files), , \u2022 Facebook    (which posts can a user read), etc (which posts can a user read), etc , etc 3 Maybe the following is a more sensible question. \u2022 \u201cDoes TikTok discover other nodes in the local area network?\u201d In the context of Access control, \u2022 \u201cDoes Android\u2019s access control allows an app such as TikTok to discover all the nodes in the same local area network?\u201d",
  "5": "Access control About controlling operations on objects by subjects. 4 Subjects: users Objects: file Operations: read, write",
  "6": "\u2022 IT and computer system handles resources such as files, printers, network, etc.    Certain resources can only be accessed by certain entities.   Access control is about controlling such accesses.    Different application have different requirements.  Generally, it is about \u201cselective restriction of access to a place or other resource\u201d (wiki).   An access control system specifies and enforces such restriction on the subject, objects and  actions. \u2022 E.g. OS, Social media (e.g. Facebook),  documents in an organization, physical access to different part of the building. \u2022 Access control provides security perimeter which in turn facilitates segregation of accesses.  Such segregation confines and localize damage caused by attacks. 5",
  "7": "Security Perimeter \u2022 Access control setup security perimeter/boundary. \u2022 With the boundary, malicious activities (e.g. malware) outside of the boundary would not affect resources within the perimeter. Furthermore, malicious activities within the boundary stays within the boundary. 6 Design of the boundary is guided by \u2022 Principle of least privilege \u2022 Compartmentalization \u2022 Defense in depth / Swiss Cheese Model \u2022 Segregation of duties \u2022 etc Swiss cheese model image from https://en.wikipedia.org/wiki/Swiss_cheese_model compartmentalization",
  "8": "Security Perimeter Examples: \u2022 A calculator apps shouldn\u2019t need to have access to the contact list to carry out its task. So, it is better not to grant the calculator apps access to the contact list. With that, even if the app is malicious or  vulnerable, the Confidentiality/Integrity of contact still preserved. (Principle of Least privilege) of Least privilege) ) \u2022 A school website hosts two services: (1) course\u2019s fee payment and (2) exam result. With the perimeter between them,  the exam result system would remain intact even if an SQL injection attack has been successfully carried out on the fee payment system. (Compartmentalization) ) \u2022 Colonial Pipeline\u2019s ransomware attack compromised the IT\u2019s system that handle client\u2019s database.  If proper perimeter being setup between the IT and OT (Operation Technology) system,  the failure of the client\u2019s database system should not affect OT system that manages the fuel pipeline. (Compartmentalization). ). \u2022 A company deploys a firewall separating their server from DMZ. An IDS (intrusion Detection System) reside in the firewall to detect malicious traffic based on known attack signature.  In addition, processes in the server are monitored for abnormal behavior.   Attack that evade the firewall might be caught by the process monitor, and vice versa. (Defence in depth)  (Swiss Cheese Model) Defence in depth)  (Swiss Cheese Model) in depth)  (Swiss Cheese Model) )  (Swiss Cheese Model) (Swiss Cheese Model) Cheese Model) ) \u2022 A company keeps backup of is business-critical data.  The company implements a policy: a single person must not have access to both the production copy and the backup copy. Assigning different components to different person is aka Segregation of Duties .  The goal is to eliminate single-point-of-failure. With that, a single  rogue system admin (insider) is unable to corrupt all. (Segregation of duties). of duties). ). 7",
  "9": "Eg of Security Perimeter on Android \u201cThe purpose of a permission is to protect the privacy of an Android user. Android apps must request permission to access sensitive user data (such as contacts and SMS), as well as certain system features (such as camera and internet). Depending on the feature, the system might grant the permission automatically or might prompt the user to approve the request. A central design point of the Android security architecture is that no app, by default, has permission to perform any operations that would adversely impact other apps, the operating system, or the user. . This includes reading or writing the user's private data (such as contacts or emails), reading or writing another app's files, performing network access, keeping the device awake, and so on.\u201d From https://developer.android.com/guide/topics/permissions/overview https://developer.android.com/guide/topics/permissions/overview In Android, each app is associated with a \u201cmanifest file\u201d  which listed down permissions the app wishes to have. (this is the requests by the app, not the actual granted permission).  During runtime, the os would grant the request based on default setting or prompt the user. 8 Essentially: Apps 1 Apps 2 Apps 3 User 1 User 2 User 3 Android Typical multi-user system no boundary between two apps running by the same user.",
  "10": "Eg on Android:   Implications \u2022 Comparing two applications (e.g. a game G and an image editing tool T ), both implemented for Window and Android. Alice  installed both G and T in a desktop running Window,  and a devices running Android. \u2022 Question: \u2022 Can T read/write files generated by G ?  Example, the game G generated an image and the user wanted to edit the image using T. (yes for window, no for android) \u2022 While G is executing,  can T access the memory space of T ? (no for both) \u2022 Can T modify the installation of G ? (No, but yes for early versions of Window) \u2022 In Android/ios, how to pass information/data from one app to another?  (user need to explicitly give permission by indicating in \u201cshare\u201d) \u2022 Isolation of apps is a key design consideration in Android. \u2022 Newer versions of OS (e.g. Window and Mac) starts to impose boundary between apps. 9",
  "11": "Definitions: Principal/Subject, Operation, Object \u2022 A A principal (or subject ) wants to access an object with some operation .   The reference monitor either grants or denies the access. 10 Principal Do operation Reference monitor object E.g. Canvas: \u2022 a student wants to submit a forum post . \u2022 a TA wants to read the grade of student in another group . File system: \u2022 a user wants to delete a file . \u2022 a user wants to change the mode of a file so that it can be read by another user Bob. OS: \u2022 An app (e.g. touch light) wants access to the phone. \u2022 An app wants to read files generated by another app.",
  "12": "Some terminologies Principals vs Subjects: \u2022 Principals :   the human users. \u2022 Subjects :   The entities in the system that operate on behalf of the principals. Accesses to objects can be classified to the following: \u2022 Observe : e.g.  Reading a file.   (Canvas, downloading a file from workbin) (Canvas, downloading a file from workbin) \u2022 Alter :  e.g. writing a file, deleting a file, changing properties.  (Canavs: uploading a file to (Canavs: uploading a file to the workbin). . \u2022 Action : e.g executing a program. 11",
  "13": "Definitions: Ownership Every object has an \u201cowner\u201d. Who decides the access rights to an object? There are two options: (1) The owner of the object decides the rights. (known as discretionary access control ) (2) A system-wide policy decides.  (known as mandatory access control ) . Mandatory access control are strict rules that everyone must follow. 12",
  "14": "9.2 Access Control Matrix 13",
  "15": "Access Control Matrix How to specify the access right of a particular principal to a particular object?    Using a table. Although the above access control matrix can specify the access right for all pairs of principals and objects, the table would be very large, and thus different to manage. Hence, it is seldom explicitly stored. r:read, w:write, x:execute, s: execute as owner,  o: owner 14 my.c mysh.sh sudo a.txt root {r,w} {r,x} {r,s,o} {r,w} Alice {r,w} {r,x,o} {r,s} {r,w,o} Bob {r,w,o} {} {r,s} {} object principals Operation / ownership",
  "16": "Access Control List  (ACL) & Capabilities The access control matrix can be represented in two different ways: ACL or capabilities. ACL: An ACL stores the access rights to an object as a list. Capabilities: A subject is given a list of  capabilities, where each capability is the access rights to an object. \u201ca capability is an unforgeable token that gives the possessor certain rights to an object\u201d 15",
  "17": "\u2022 ACL ACL \u2022 Capability 16 my.c mysh.sh sudo a.txt root {r,w} {r,x} {r,s,o} {r,w} Alice {} {r,x,o} {r,s} {r,w,o} Bob {r,w,o} {} {r,s} {} my.c \u2192 (root, {r,w} ) \u2192 (Bob, {r,w,o} ) mysh.sh \u2192 (root, {r,x} ) \u2192 (Alice, {r,x,o} ) sudo \u2192 (root, {r,s,o} ) \u2192 (Alice, {r,s} ) \u2192 (Bob, {r,s} ) a.txt \u2192 (root, {r,w} ) \u2192 (root, {r,w,o} ) root \u2192 (my.c, {r,w} ) \u2192 (mysh.sh, {r,x} ) \u2192 (sudo, {r,s,o}) \u2192 ( a.txt, {r,w}) Alice \u2192 (mysh.sh, {r,x,o} ) \u2192 (sudo, {r,s}) \u2192 ( a.txt, {r,w,o}) Bob \u2192 (my.c, {r,w,o}) \u2192 (sudo, {r,s})",
  "18": "For ACL, it is difficult to obtain the list of objects a particular subject has access to. Conversely, for capabilities, it is difficult to get the list of subjects who have access to a particular object. \u2022 To illustrate,  note that Unix file system employs ACL.  Suppose the system admin wants to generate the list of files that user alice0012 has \u201cr\u201d access to.  How to  generate this list? 17",
  "19": "9.3 Intermediate Control We want an intermediate control that is fine grain (e.g. in Facebook, allow user to specify which friend can view a particular photo) and yet and yet easy to manage . 18",
  "20": "It is not practical for an owner to specific each single entries in the access control matrix.  So, we need some ways to simplify the representation. One method is to \u201cgroup\u201d the  subjects/objects and define the access rights on the group.  This is called intermediate control. Most access control systems have such grouping.  Next few slides are examples. 19",
  "21": "Intermediate Control: Grouping Example: Unix File system. In Unix file permission, subjects are divided into groups.  Unix file permission uses ACL. For each object, the owner specific the rights for \u2022 owner, \u2022 group, \u2022 world (everyone). (for the precise definition, see next section) --w-r--r-- 1 alice staff 3 Mar 13 00:27 temp 20",
  "22": "Example of grouping \u2022 In Canvas, project groups can be created by lecturer. Objects created in a group can only be read by members in the group + lecturer. \u2022 In Unix, groups can only be created by root. The groups information In Unix, groups can only be created by root. The groups information The groups information is stored in the file /etc/group 21 u1 u2 u3 u4 u5 o1 o2 o3 o4 o5 group 1 group 2 group 3",
  "23": "Intermediate control: Role-based access control The grouping can be determined by the \u201crole\u201d of the subject. A role associates with a collection of procedures.  To carry out these procedures, access rights to certain objects are required. E.g. In Canvas,  there are predefined rights for different roles: \u201cLecturer\u201d, \u201cTA\u201d and \u201cStudent\u201d.   When Alice enrolled to CS2107 as student, her rights are inherited from the role \u201cStudent\u201d.  When Alice volunteered as TA in CS1010, her rights are inherited from the role \u201cTA\u201d in CS1010. To design the access right of a role, we should follow the least privilege principle , i.e. access rights that are not required to complete the role will not be assigned. e.g.   Consider Canvas\u2019s gradebook. The task of a student Teaching Assistance include entering the grade for each students.  So we should give the TA \u201cwrite\u201d access to the gradebook so that the TAs can complete their task.  Should we give the TAs the right to delete a gradebook?  Since this access right is not required for the TA to complete their task, by the least privilege principle, the TA should not be given this access right. 22 u1 u2 u3 u4 u5 o1 o2 o3 o4 o5 Lecturer Student TA",
  "24": "Intermediate Control: privileges We sometime use the term privilege to describe the access right. Privilege can also be viewed as an intermediate control. It can be represented by a number, e.g. 1,2,3. if a subject can access an object,  another subject with higher privilege can also access the object. 23 u1 u2 u3 u4 u5 o1 o2 o3 o4 o5 privilege 3 privilege  2 privilege  1",
  "25": "Intermediate control:  Protection rings In OS, \u201cprivilege\u201d is often called protection rings. \u201cPrivilege\u201d and \u201cRings\u201d are essentially the same but with different names. In protection rings,  each object (data)  and subject (process) is assigned a number.  Whether a subject can access an object is determined by their respective assigned number. Object with smaller number are more important.   If a process is assigned a number i , we say that the process runs in ring i . We call processes with lower ring number as having  \u201c higher privilege \u201d. A subject cannot access (both read/write) an object with smaller ring number. Unix has only 2 rings, superuser and user . e.g. 24 0 3 2 1 High privilege process Low privilege process High privilege Object Low privilege Object R,W W R,W W",
  "26": "Two non-intuitive examples of intermediate control: Bell-LaPadula vs Biba In protection rings, a subjects has read/write access to objects that are classified with the same or lower privilege. Are there reasonable alternatives? Here are two well-known models: Bell-LaPadula and Biba.  Although they are rarely implemented as-it-is in computer system, they illustrate the differences of Integrity vs Confidentiality in access control. In both models, objects and subjects are divided into linear levels. Level 0, level 1, level 2, ... higher level corresponds to higher \u201csecurity\u201d. (The numbering is opposite of protection ring.  This is just a different choice of notations). 25 level 2 level 1 level 0",
  "27": "Bell-LaPadula Model  (for data confidentiality) Read  https://en.wikipedia.org/wiki/Bell%E2%80%93LaPadula_model https://en.wikipedia.org/wiki/Bell%E2%80%93LaPadula_model Restrictions imposed by the Bell-Lapadula Model: The following restrictions are imposed by the model: \u2022 no read up : A subject  does not have read access to object in higher level.   This prevent  a lower level from getting info in the higher level. \u2022 no write down : A subject does not have append-right to object in lower level.   This prevents a malicious insider from passing information to lower levels. (e.g. a clerk working in the highly classified department is forbidden to gossip with other staff). For \u201cConfidentiality\u201d. (A subject can append to objects at higher security level. Is it possible that, by appending to an object, one could distort its original content? Yes. See e.g. in renegotiation attack.) 26",
  "28": "Biba Model (for process integrity) Restrictions imposed by the Biba Model: The following restrictions are imposed by the model: \u2022 no write up : A subject does not has  \u201cwrite\u201d access to objects in  higher level. This prevent a malicious subject from poisoning  upper level data, and thus ensure that a process will not get compromised by lower level subjects. \u2022 no read down : A subject  does not has read access to objects lower level. This prevents a subject from reading data poisoned by lower level subjects. For \u201cIntegrity\u201d. If a model imposes both Biba and Bell-LaPadula, subjects can only read/write to objects in the same level (not practical). 27",
  "29": "Direction of information flow 28 H level process L level process H level H object L level object R,W W R,W W H level process L level process H level object L level object object R,W W R,W W Biba  (Integrity) No \u201dmalicious\u201d  information going up. Bell-LaPadula (confidentiality) No \u201csensitive\u201d information leaking down no read-up no write-down no write-up no read-down",
  "30": "9.4 Unix File system To get Unix or Unix-like environment in Windows: \u2022 (Virtual Machine as in the assignment):  Install a hypervisor or virtual machine monitor (VMM) such as VirtualBox (https://www.virtualbox.org), or VMWare (https://www.vmware.com). Then install Linux https://www.vmware.com). Then install Linux ). Then install Linux (e.g. Ubuntu desktop ). \u2022 A Unix-like environment in Windows is  cygwin https://www.cygwin.com/ \u2022 Another method:  Bash shell in Window 10. https://www.howtogeek.com/249966/how-to-install-and-use-the-linux-bash-shell-on-windows-10/ 29",
  "31": "Unix file system Access control. In Unix, objects includes files, directories, memory devices and I/O devices.   All these resources are treated as files. read wiki  http://en.wikipedia.org/wiki/File_system_permissions http://en.wikipedia.org/wiki/File_system_permissions %ls \u2013al -r-s--x--x  1 root  wheel   164560 Sep 10  2014 sudo -rwxr-xr-x  2 root  wheel    18608 Nov  7 06:32 sum -rw-r--r-- 1 alice staff 124 Mar  9 22:29 myprog.c lr-xr-xr-x  1 root  wheel        0 Mar 12 16:29 stdin Question:  what are the files in the following directories? /dev /dev/stdin /dev/stdout /dev/urandom 30",
  "32": "File system permission -rw-r--r-- 1 alice staff 124 Mar  9 22:29 my.c 31 File permission owner group file size filename date & time of last modification. links count. (not relevant in this module) (not relevant in this module) indicates whether it is a file or directory The file permission are grouped into 3 triples, that define the read , write , execute access for owner, group, other (also called the \u201cworld\u201d). A \u2018-\u2019  indicates access not granted. Otherwise r:  read w: write         (including delete) x:  execute   (s: allow user to execute with the permission of the owner) owner group other",
  "33": "Principals,  Subjects \u2022 Principals are user-identities (UIDs) and group - identities (GIDs) \u2022 Information of the user accounts are stored in the \u201cpassword\u201d file /etc/passwd e.g. root:*:0:0:System Administrator:/var/root:/bin/sh read wiki page for details of these fields. https://en.wikipedia.org/wiki/Passwd \u2022 The subjects are processes.  Each process has a process ID (PID).    (e.g. in Unix, the commend ps \u2013 alx  display a list of processes). 32 Earliest versions of unix place the hashed password here.  Still maintain the field for backward compatibility.",
  "34": "Optional Side Remarks on the \u201cPassword file\u201d  /etc/passwd \u2022 The file is made world-readable  because the account information in  /etc/passwd should be accessible by other users. In earlier version of Unix , the \u201c*\u201d in the file was the hashed password H(pw), where H() is some cryptographic hash, and pw the password of the user.   Hence, previously all users can see the hashed passwords of others. \u2022 With knowledge of the hashed password, the attackers can carry out offline dictionary attack. To prevent that, it is now replaced as \u201c*\u201d, and the actual hashed passwords are stored somewhere else and not world-readable.     (You may wonder why can\u2019t .     (You may wonder why can\u2019t (You may wonder why can\u2019t the we completely remove the field. This is for backward compatibility. If the field is completely removed, some existing programs might not work.) \u2022 Hence, unlike in original design of Unix-based system,  the file  /etc/passwd  is now not storing information of the password. It is just due to the legacy  issue that it keeps the name \u201cpasswd\u201d. 33",
  "35": "superuser(root) \u2022 A special user is the superuser, with UID 0 and usually with the username root. All security checks are turned off for root. (Unix\u2019s protection rings consists of 2 rings:  superuser, user) 34",
  "36": "Checking rules for file access \u2022 The objects are files. Each file is associated with a 9-bit permission.  Each file is owned by a user, and a group. \u2022 When a user (subject) wants to access a file (object), the following are checked in the order: 1. If the user is the owner, the permission bits for owner decide the access rights. 2. If the user is not the owner, but the user\u2019s group (GID) owns the file, the permission bits for group decide the access rights. 3. If the user is not the owner, nor member of the group that own the file, then the permission bits for other decide. The owner of a file, or superuser can change the permission bits. 35",
  "37": "Unix\u2019s Access Control and Reference Monitor 36 F1 Process invoked by user. (2) Let me check the ACL of  F1. (1) I want to access F1 and my Id is so- and-so F2 F3 acl acl acl checking rules. \u2022 When a user (subject) wants to access a file (object), the following are checked, in the following order: 1. If the user is the owner, the permission bits for owner decide the access rights. 2. If the user is not the owner, but the user\u2019s group (GID) owns the file, the permission bits for group decide the access rights. 3. If the user is not the owner, nor member of the group that own the file, then the permission bits for other decide. The owner of a file, or superuser can change the permission bits.",
  "38": "9.5 Controlled Invocation & privilege elevation 37 Two separated environments ensure segregation for security. However, to be useful,  we need interaction between them. Solution: no free-flow of interactions but \u201ccontrolled\u201d interactions.",
  "39": "Controlled invocation Eg in Unix: Some sensitive resources (such as network port  0 to 1023, printer) should be should be accessible only by the superuser. However, users  sometime need those resources. Eg: Consider a file F that contains  home addresses of  all staffs.  Clearly, we cannot grant any user to read F .   However, we must allow a user to read/modify his/her address and thus need to make it readable/writeable to that user.  The polarized setting where either a process can read or cannot  read a file would get stuck! Solution: controlled invocation . \u2022 The system  provides a predefined set of applications that have access to F. \u2022 These application is granted \u201celevated privilege\u201d so that they can freely access the file, and any user can invoke the application.  Now,  any user can access F via the application. \u2022 The programmer who write the application bear the responsibility to make sure that the application only performed intended limited operation. 38",
  "40": "Without controlled escalation 39 Staff.txt A ((low privilege) process invoked by alice01 (2) Let me check  the access control of Staff.txt. Sorry, no access. (1) I want to modify the file staff.txt and my Id is  alice01 alice01 doesn\u2019t has access right to Staff.txt. Any processes (subject) invoked by alice01 inherit alice01\u2019s right F acl alice01 with low  privilege",
  "41": "With Controlled escalation 40 Staff.txt Predefined (high privilege) executable file  invoked by alice01 (1) I want to change the file Staff.txt and I have the same privilege as root. There is a set of predefined applications with \u201celevated\u201d privilege.  A normal user alice01 can\u2019t create applications with high privilege.  However, any user can invoke these predefined applications. F acl alice01 (low  privilege) (2) Let me check  the access control of Staff.txt. ACL indicates that root has access. Ok. Granted",
  "42": "Bridges with Elevated Privilege \u2022 We can view the predefined application as a predefined \u201cbridges\u201d  for the user to access sensitive data.  (note that the \u201cbridge\u201d can only be built by the system.) 41 user with low privilege Sensitive data/files Set of predefined applications with elevated privilege. These applications can only carry out limited operations. BANK application (Web Server) SQL database Server user Firewall ensure that users can\u2019t directly send query to the  SQL database server.   Users has controlled access to SQL server. SQL Server:  I will process any query sent from the web server Web Server: I will only issue certain type of queries. Internet DMZ Internal zone",
  "43": "\u2022 Suppose a \u201cbridge\u201d is not implemented correctly and contains exploitable vulnerabilities. In some vulnerabilities,  an attacker can trick the bridge to perform \u201cillegal\u201d operations not expected by the programmer/designer.   This would have serious implication, since the process is now running with \u201c elevated privilege \u201d. \u2022 Attacks of such form is also known as \u201c privilege escalation \u201d. \u201cPrivilege escalation is the act of exploiting a bug, design flaw or configuration oversight in an operating system bug, design flaw or configuration oversight in an operating system , design flaw or configuration oversight in an operating system operating system or software application software application to gain elevated access to resources resources that are normally protected from an application or user. The result is that an application with user. The result is that an application with . The result is that an application with more privileges privileges than intended by the application developer application developer or system administrator system administrator can perform unauthorized unauthorized actions.\u201d -   https://en.wikipedia.org/wiki/Privilege_escalation https://en.wikipedia.org/wiki/Privilege_escalation 42",
  "44": "Bugs in bridge leads to Privilege escalation. 43 Sensitive data/files Bridge with \u201cBug\u201d. Input crafted by malicious user, with \u201cmalicious payload\u201d BANK application (Web Server) SQL database Server user A bug in BANK that allows the user to send in arbitrary query.    (SQL injection)",
  "45": "9.6 Controlled Invocation in UNIX Real UID, Effective UID,  privilege escalation The definitions, steps are very complicated with many exceptions. Complexity is bad for security.  Programmers often get confused which leads to buggy implementation. 44",
  "46": "Let\u2019s recap Unix\u2019s Access Control and Reference Monitor 45 F1 Process invoked by user. (2) Let me check the ACL of  F1. (1) I want to access F1 and my Id is so- and-so F2 F3 acl acl acl checking rules. \u2022 When a user (subject) wants to access a file (object), the following are checked, in the following order: 1. If the user is the owner, the permission bits for owner decide the access rights. 2. If the user is not the owner, but the user\u2019s group (GID) owns the file, the permission bits for group decide the access rights. 3. If the user is not the owner, nor member of the group that own the file, then the permission bits for other decide. The owner of a file, or superuser can change the permission bits.",
  "47": "More definitions before we move on: Process and Set userID (SUID) (the unix command ps list the current running processes) \u2022 A process is a subject. \u2022 A process has an identification (PID). New process can be created by executing a file or by \u201cforking\u201d  an existing process. \u2022 A process is associated with a Real UID and an Effective UID . \u2022 The real UID is inherited from the user who invokes the process. For e.g. if the user is alice , then the real UID is alice. \u2022 Processes can be created by executing a file.  Each executable file has a SUID flag. There are two cases: \u2022 If the Set User ID (SUID) is disabled (the permission will be displayed as \u201c x \u201d), then the process\u2019 effective UID is same as real UID. \u2022 If the Set User ID (SUID) is enabled (the permission will be displayed as \u201c s \u201d), then the process\u2019 effective UID is inherited from the  UID of the file\u2019s owner . 46",
  "48": "Demo: ps -eo user,pid,ruid,uid,ppid,args 47 effective UID real UID",
  "49": "Example e.g. If alice invokes the process by executing the file: -r- x r-xr-x   1 root  staff     6 Mar 18 08:00 check then the new process\u2019s Real UID           is alice Effective  UID  is alice e.g.  If alice invokes the process by executing the file: -r- s r-xr-x   1 root  staff     6 Mar 18 08:00 check1 then the new process\u2019s Real UID           is alice Effective  UID  is root 48 This indicates that SUID is enabled. Owner of file This indicates that SUID is disabled.",
  "50": "When a process (subject) wants to read/write/execute a file (object) When a process wants to access a file, the effective UID of the process is treated as the \u201csubject\u201d and checked against the file permission to decide whether it will be granted or denied  access. E.g  consider a file own by the root. -rw-------   1 root  staff     6 Mar 18 08:00 sensitive.txt \u2022 If the effective UID of a process is If the effective UID of a process is alice then the process is denied access to the file. \u2022 If the effective UID of a process is If the effective UID of a process is root , then the process is allowed to access the file. 49",
  "51": "Use Case Scenario of \u201cs\u201d (SUID) \u2022 Consider a scenario where the file employee.txt contains personal information of the users. \u2022 This is sensitive information, hence, the system administrator set it to non-readable except by root: -rw-------   1 root  staff     6 Mar 18 08:00 employee.txt \u2022 However, users should be allowed to self-view and even self-edit some fields (for e.g. postal address) of their own profile. Since the file permissible is set to \u201c-\u201d for all users (except root), a process created by any user (except root) cannot read/write it. \u2022 Now, we are stuck: there are data in the file that  we want to protect, and data that we want the user to access. \u2022 What can we do? 50",
  "52": "51 Sensitive data/files Process invoked by Alice , a non-root user. (2) According to ACL, Only root can access it. (1) I want to change my home address ACL",
  "53": "Solution \u2022 Create an executable file editprofile owned by root: -r-sr-xr-x   1 root  staff     6 Mar 18 08:00 editprofile \u2022 The program is made world-executable so that The program is made world-executable so that any user can execute it. \u2022 Furthermore, the permission is set to be \u201cs\u201d: when it is executed, its effective UID will be \u201croot\u201d \u2022 Now, if alice executes the file, the process\u2019 real UID is alice , but its effective UID is root. Following the checking rule, this process can now read/write the file employee.txt .txt 52",
  "54": "53 Sensitive data/files Process invoked by alice . The process is invoked by executing a program created by the root, with permission \u201cs\u201d. ok My effective UID is root ACL",
  "55": "Summary:  When SUID is Disabled \u2022 If the user alice invokes the executable, the process will have its effective ID as alice \u2022 When this process wants to read the file employee.txt , the OS (reference monitor) will deny the access 54 -rw---- --- 1 root  staff     6 Mar 18 08:00 employee.txt -r- x r-xr-x   1 root  staff 6 Mar 18 08:00 editprofile Process info: name ( editprofile )    real ID ( alice )    effective ID ( alice )",
  "56": "Summary:  When SUID is Enabled \u2022 But if the permission of the executable is \u201cs\u201d instead of \u201cx\u201d, then the invoked process will has root as its effective ID \u2022 Hence the OS grants the process to read the file \u2022 Now, the process invoked by Now, the process invoked by alice can access employee.txt 55 -rw---- --- 1 root  staff     6 Mar 18 08:00 employee.txt -r- s r-xr-x   1 root  staff     6 Mar 18 08:00 editprofile Process info: name ( editprofile )    real ID ( alice )   effective ID ( root )",
  "57": "Elevated Privilege \u2022 In this example,  the process editprofile is elevated to superuser (i.e. root), so that it can access sensitive data.   We can view  the elevated process as the interfaces where a user can access the \u201csensitive\u201d information. - They are the predefined \u201cbridges\u201d  for the user to access the data. - The \u201cbridge\u201d can only be built by the root. \u2022 These bridges solve the problem.  However,  it is important that these \u201cbridges\u201d are correctly implemented and do not leak more than required. 56 user with low privilege can access sensitive data indirectly via the bridge Sensitive data/files Bridge Predefined processes with permission \u201cs\u201d the user can invoke",
  "58": "\u2022 If the bridge is not built securely, there could be privilege escalation attack. 57 Sensitive data/files Bridge with \u201cBug\u201d. Input crafted by malicious user, with \u201cmalicious payload\u201d"
}